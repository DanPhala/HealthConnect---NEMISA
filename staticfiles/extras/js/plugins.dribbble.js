!function(o){"use strict";o.jribbble={};function r(e,t){if(e&&"object"!=typeof e)return e;throw new Error(h.idRequired(t))}function s(e){var t={};return e.forEach(function(e){t[e]=function(r){return function(t){return this.queue.add(function(e){e.url+="/"+r+"/"+a(t||{})}),this}}.call(this,e)}.bind(this)),t}function i(e){if(0!==e.length){var t=e[0],r=typeof t,e={};return"number"==r||"string"==r?-1<l.indexOf(t)?e.list=t:e.resource=t:"object"==r&&(e=t),e}}function u(){var e=o.extend({},o.Deferred());return e.queue=new function(){return this.methods=[],this.response=null,this.flushed=!1,this.add=function(e){this.flushed?e(this.scope):this.methods.push(e)},this.flush=function(e){if(!this.flushed){for(this.scope=e,this.flushed=!0;this.methods[0];)this.methods.shift()(e);return e}},this},e.url=c,e.get=function(){return t?(o.ajax({type:"GET",url:this.url,beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+t)},success:function(e){this.resolve(e)}.bind(this),error:function(e){this.reject(e)}.bind(this)}),this):(console.error(h.token),!1)},e}function n(r){return function(t){return o.extend(this,u()),this.queue.add(function(e){e.url+="/"+r+"/"+t}),setTimeout(function(){this.queue.flush(this).get()}.bind(this)),this}}var t=null,c="https://api.dribbble.com/v1",l=["animated","attachments","debuts","playoffs","rebounds","teams"],h={token:"Jribbble: Missing Dribbble access token. Set one with $.jribbble.accessToken = YOUR_ACCESS_TOKEN. If you do not have an access token, you must register a new application at https://dribbble.com/account/applications/new",singular:function(e){return e.substr(0,e.length-1)},idRequired:function(e){return"Jribbble: You have to provide a "+this.singular(e)+' ID. ex: $.jribbble.%@("1234").'.replace(/%@/g,e)},subResource:function(e){return"Jribbble: You have to provide a "+this.singular(e)+' ID to get %@. ex: $.jribbble.%@("1234").%@()'.replace(/%@/g,e)},shotId:function(e){return"Jribbble: You have to provide a shot ID to get %@. ex: "+' $.jribbble.shots("1234").%@()'.replace(/%@/g,e)},commentLikes:'Jribbble: You have to provide a comment ID to get likes. ex:  $.jribbble.shots("1234").comments("456").likes()'},a=function(e){e=o.param(e);return e?"?"+e:""};o.jribbble.shots=function(e,t){function r(n){return function(e,t){var r=i([].slice.call(arguments))||{},s=t||{};return this.queue.add(function(e){if(!e.shotId)throw new Error(h.shotId(n));e.url+="/"+n+"/",r.resource&&(e.url+=r.resource,delete r.resource),e.url+=a(o.extend(r,s))}),this}}var s=i([].slice.call(arguments))||{},n=t||{},t=function(){return o.extend(this,u()),this.url+="/shots/",this.queue.add(function(e){s.resource&&(e.shotId=s.resource,e.url+=s.resource,delete s.resource),e.url+=a(o.extend(s,n))}),setTimeout(function(){this.queue.flush(this).get()}.bind(this)),this};return t.prototype.attachments=r("attachments"),t.prototype.buckets=r("buckets"),t.prototype.likes=r("likes"),t.prototype.projects=r("projects"),t.prototype.rebounds=r("rebounds"),t.prototype.comments=function(e,t){var r=i([].slice.call(arguments))||{},s=t||{};return this.queue.add(function(e){if(!e.shotId)throw new Error(h.shotId("comments"));e.url+="/comments/",r.resource&&(e.commentId=r.resource,e.url+=r.resource+"/",delete r.resource),e.url+=a(o.extend(r,s))}),this.likes=function(e){var t=e||{};return this.queue.add(function(e){if(!e.commentId)throw new Error(h.commentLikes);e.url+="likes/"+a(t)}),this},this},new t},o.jribbble.teams=function(e){var t=r(e,"teams"),e=n.call(this,"teams");return e.prototype=s.call(this,["members","shots"]),new e(t)},o.jribbble.users=function(e){var t=r(e,"users"),e=n.call(this,"users");return e.prototype=s.call(this,["buckets","followers","following","likes","projects","shots","teams"]),e.prototype.isFollowing=function(t){return this.queue.add(function(e){e.url+="/following/"+t}),this},new e(t)},o.jribbble.buckets=function(e){var t="buckets",e=r(e,t),t=n.call(this,t);return t.prototype=s.call(this,["shots"]),new t(e)},o.jribbble.projects=function(e){var t="projects",e=r(e,t),t=n.call(this,t);return t.prototype=s.call(this,["shots"]),new t(e)},o.jribbble.setToken=function(e){return t=e,this}}(jQuery,(window,document));